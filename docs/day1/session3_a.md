---

# ğŸ§© [Session 3 ì¶”ê°€ ì‹¤ìŠµ] AI ë‰´ìŠ¤ ìš”ì•½ ë´‡ ë§Œë“¤ê¸°

## ëª©í‘œ

* **NewsAPI**ë¥¼ í†µí•´ ë§¤ì¼ ìµœì‹  ë‰´ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì§‘í•©ë‹ˆë‹¤.
* ìˆ˜ì§‘ëœ ë‰´ìŠ¤(5ê±´)ë¥¼ **Code ë…¸ë“œ**ë¡œ ì •ë¦¬í•˜ì—¬ í•˜ë‚˜ì˜ í…ìŠ¤íŠ¸ë¡œ í•©ì¹©ë‹ˆë‹¤.
* **OpenAI(ChatGPT)**ì—ê²Œ "ì˜¤ëŠ˜ì˜ ë‰´ìŠ¤ íë¦„ì„ ìš”ì•½í•´ì¤˜"ë¼ê³  ì‹œí‚µë‹ˆë‹¤.
* ìš”ì•½ëœ ê²°ê³¼ë¥¼ **Google Chat** ìŠ¤í˜ì´ìŠ¤ë¡œ ì „ì†¡í•©ë‹ˆë‹¤. (ì„ íƒ ì‚¬í•­)

---

## ì „ì²´ ì›Œí¬í”Œë¡œìš° (Workflow)

```
graph LR
    A[Cron (ë§¤ì¼)] --> B[HTTP Request (ë‰´ìŠ¤ìˆ˜ì§‘)]
    B --> C[Code (ë°ì´í„° ê°€ê³µ)]
    C --> D[OpenAI (ìš”ì•½)]
    D --> E[Google Chat (ì „ì†¡)]

```

---

## 0ï¸âƒ£ ì‚¬ì „ ì¤€ë¹„

1. **NewsAPI í‚¤ ë°œê¸‰**: [https://newsapi.org](https://newsapi.org) ê°€ì… í›„ API Key ë³µì‚¬
2. **OpenAI API í‚¤**: ìˆ˜ì—… ì‹œê°„ì— ì‚¬ìš©í•œ í‚¤ ì¤€ë¹„
3. **Google Chat ìŠ¤í˜ì´ìŠ¤ ìƒì„±**:
* [Google Chat](https://mail.google.com/chat)
* **ìƒˆ ìŠ¤í˜ì´ìŠ¤ ë§Œë“¤ê¸°** (ì´ë¦„ ì˜ˆ: `ë‚´ ë‰´ìŠ¤ ì•Œë¦¼ë°©`)
* âš ï¸ **ì¤‘ìš”:** ê°œì¸ ê³„ì •ì—ì„œëŠ” 'ë‚˜ì™€ì˜ ì±„íŒ…'ì´ ì•„ë‹Œ **'ìŠ¤í˜ì´ìŠ¤(Space)'**ë¥¼ ë§Œë“¤ì–´ì•¼ ì›¹í›…ì„ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.



---

## 1ï¸âƒ£ Cron ë…¸ë“œ â€“ ìŠ¤ì¼€ì¤„ëŸ¬

ë§¤ì¼ ì•„ì¹¨ ë‰´ìŠ¤ë¥¼ ë°›ì•„ì˜¤ê¸° ìœ„í•œ íŠ¸ë¦¬ê±°ì…ë‹ˆë‹¤.

* **Node:** `Schedule` (êµ¬ Cron)
* **Trigger Interval:** `Every Day`
* **Hour:** `08` (ì˜¤ì „ 8ì‹œ) / **Minute:** `00`
* *(ì‹¤ìŠµ ì‹œì—ëŠ” `Manual Trigger`ë¥¼ ì—°ê²°í•´ë‘ê³  í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.)*



---

## 2ï¸âƒ£ HTTP Request â€“ ë‰´ìŠ¤ ìˆ˜ì§‘

ìµœì‹  í—¤ë“œë¼ì¸ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

* **Node:** `HTTP Request`
* **Method:** `GET`
* **URL:** `https://newsapi.org/v2/top-headlines`
* **Query Parameters:**
* `country`: `kr`
* `apiKey`: `(ì—¬ëŸ¬ë¶„ì˜ NewsAPI Key)`


* **Authentication:** `None` (íŒŒë¼ë¯¸í„°ì— í‚¤ë¥¼ ë„£ì—ˆìœ¼ë¯€ë¡œ ì—†ìŒ)

---

## 3ï¸âƒ£ Code ë…¸ë“œ â€“ ë°ì´í„° í•˜ë‚˜ë¡œ í•©ì¹˜ê¸° (ì¤‘ìš”!)

ê°€ì ¸ì˜¨ ë‰´ìŠ¤ ê¸°ì‚¬ 5ê°œë¥¼ **í•˜ë‚˜ì˜ ê¸´ í…ìŠ¤íŠ¸**ë¡œ ë¬¶ì–´ì„œ AIì—ê²Œ ì „ë‹¬í•´ì•¼ í•©ë‹ˆë‹¤. (ë”°ë¡œ ë³´ë‚´ë©´ AIê°€ 5ë²ˆ ì‹¤í–‰ë©ë‹ˆë‹¤.)

* **Node:** `Code` (êµ¬ Function)
* **Language:** `JavaScript`
* **Code:** (ì•„ë˜ ì½”ë“œë¥¼ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”)

```javascript
// ì´ì „ ë…¸ë“œ(HTTP Request)ì—ì„œ ê°€ì ¸ì˜¨ ê¸°ì‚¬ ëª©ë¡
const articles = items[0].json.articles;

// ìƒìœ„ 5ê°œë§Œ ìë¥´ê¸°
const top5 = articles.slice(0, 5);

// ê¸°ì‚¬ ì œëª©ê³¼ ë§í¬ë¥¼ í•˜ë‚˜ì˜ ë¬¸ìì—´ë¡œ í•©ì¹˜ê¸°
let newsText = "";
top5.forEach((article, index) => {
  newsText += `${index + 1}. ${article.title}\n   (ë§í¬: ${article.url})\n\n`;
});

// ë‹¤ìŒ ë…¸ë“œ(OpenAI)ë¡œ ë„˜ê²¨ì¤„ ë°ì´í„° í¬ë§·íŒ…
return [
  {
    json: {
      news_content: newsText
    }
  }
];

```

---

## 4ï¸âƒ£ OpenAI ë…¸ë“œ â€“ ìš”ì•½í•˜ê¸°

í•©ì³ì§„ ë‰´ìŠ¤ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìš”ì•½ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

* **Node:** `OpenAI Chat Model` (ë˜ëŠ” Basic LLM Chain)
* **Credential:** OpenAI API Key ì—°ê²°
* **Model:** `ê¸°ì¡´ ëª¨ë¸ ì¬ì‚¬ìš©`
* **System Message:**
```text
ë‹¹ì‹ ì€ ì „ë¬¸ ë‰´ìŠ¤ ë¸Œë¦¬í•‘ ë¹„ì„œì…ë‹ˆë‹¤. ì…ë ¥ëœ ë‰´ìŠ¤ë“¤ì„ ì¢…í•©í•˜ì—¬ í•µì‹¬ë§Œ ê°„ê²°í•˜ê²Œ ìš”ì•½í•˜ì„¸ìš”.

```


* **User Message:** (Expression ëª¨ë“œ ì¼œê¸°)
```text
ì•„ë˜ëŠ” ì˜¤ëŠ˜ í•œêµ­ì˜ ì£¼ìš” ë‰´ìŠ¤ 5ê°€ì§€ì…ë‹ˆë‹¤.

{{ $json.news_content }}

---
ìœ„ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ:
1. ì „ì²´ì ì¸ ì˜¤ëŠ˜ì˜ ì´ìŠˆë¥¼ í•œ ë¬¸ë‹¨ìœ¼ë¡œ ë¸Œë¦¬í•‘í•´ì£¼ì„¸ìš”.
2. ê° ê¸°ì‚¬ì˜ í•µì‹¬ì„ 1ì¤„ì”© ìš”ì•½ ë¦¬ìŠ¤íŠ¸ë¡œ ë§Œë“¤ì–´ì£¼ì„¸ìš”.

```



---

## 5ï¸âƒ£ Google Chat â€“ ê²°ê³¼ ì „ì†¡ (ì„ íƒ ì‚¬í•­ - ì–´ë ¤ì›€)

ê°œì¸ ê³„ì •ì—ì„œëŠ” **Incoming Webhook(ìˆ˜ì‹  ì›¹í›…)** ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ë¥¼ ë³´ëƒ…ë‹ˆë‹¤.

### 5-1. í”„ë¡œì íŠ¸ ìƒì„± ë° API í™œì„±í™”

1. [Google Cloud Console](https://console.cloud.google.com)ì— ì ‘ì†í•©ë‹ˆë‹¤.
2. ìƒˆ í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤ (ì˜ˆ: `n8n-chat-personal`).
3. **[API ë° ì„œë¹„ìŠ¤]** > **[ë¼ì´ë¸ŒëŸ¬ë¦¬]**ë¡œ ì´ë™í•©ë‹ˆë‹¤.
4. **`Google Chat API`**ë¥¼ ê²€ìƒ‰í•˜ì—¬ **[ì‚¬ìš© ì„¤ì •(Enable)]**ì„ í´ë¦­í•©ë‹ˆë‹¤.

### 5-2. OAuth ë™ì˜ í™”ë©´ êµ¬ì„±

1. **[API ë° ì„œë¹„ìŠ¤]** > **[OAuth ë™ì˜ í™”ë©´]**ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
2. **User Type:** `ì™¸ë¶€(External)` ì„ íƒ > **[ë§Œë“¤ê¸°]**.
3. **ì•± ì •ë³´:** ì•± ì´ë¦„(ì˜ˆ: `n8n-chat`), ì‚¬ìš©ì ì§€ì› ì´ë©”ì¼, ê°œë°œì ì—°ë½ì²˜ë§Œ ì…ë ¥í•˜ê³  ì €ì¥í•©ë‹ˆë‹¤.
4. **ë²”ìœ„(Scopes):** **[ë²”ìœ„ ì¶”ê°€ ë˜ëŠ” ì‚­ì œ]** í´ë¦­ > í•„í„°ì— `chat.messages` ê²€ìƒ‰ > `.../auth/chat.messages` (ë©”ì‹œì§€ ë° ë°˜ì‘ ë§Œë“¤ê¸°) ì²´í¬ > ì—…ë°ì´íŠ¸ > ì €ì¥.
* *Tip: ëª©ë¡ì— ì—†ìœ¼ë©´ ìˆ˜ë™ìœ¼ë¡œ `https://www.googleapis.com/auth/chat.messages`ë¥¼ ì…ë ¥í•˜ì„¸ìš”.*

5. **í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì(Test Users):** **[+ ADD USERS]** í´ë¦­ > **ë³¸ì¸ì˜ êµ¬ê¸€ ì´ë©”ì¼** ì…ë ¥ > ì €ì¥. (ì´ ë‹¨ê³„ê°€ ì—†ìœ¼ë©´ ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!)

### 5-3. OAuth í´ë¼ì´ì–¸íŠ¸ ID ë§Œë“¤ê¸°

1. **[ì‚¬ìš©ì ì¸ì¦ ì •ë³´(Credentials)]** > **[+ ì‚¬ìš©ì ì¸ì¦ ì •ë³´ ë§Œë“¤ê¸°]** > **[OAuth í´ë¼ì´ì–¸íŠ¸ ID]**.
2. **ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ í˜•:** `ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜`.
3. **ìŠ¹ì¸ëœ ë¦¬ë””ë ‰ì…˜ URI:**
* n8nì˜ **[Google OAuth2 API]** ìê²© ì¦ëª… ì„¤ì • ì°½ì— ìˆëŠ” URLì„ ë³µì‚¬í•´ ë„£ìŠµë‹ˆë‹¤.
* ë³´í†µ: `https://YOUR-N8N-URL/rest/oauth2-credential/callback`
* (ë¡œì»¬ ì‹¤í–‰ ì‹œ: `http://localhost:5678/rest/oauth2-credential/callback`)

4. **[ë§Œë“¤ê¸°]** í´ë¦­ > **í´ë¼ì´ì–¸íŠ¸ ID**ì™€ **í´ë¼ì´ì–¸íŠ¸ ë³´ì•ˆ ë¹„ë°€**ì„ ë³µì‚¬í•´ ë‘¡ë‹ˆë‹¤.

---

### 5-4. n8nì—ì„œ Credential ì„¤ì •

Google Chat ì „ìš© ë…¸ë“œ ëŒ€ì‹ , ë²”ìš©ì ì¸ **HTTP Request**ì™€ **Google OAuth2** ìê²© ì¦ëª…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

1. n8nì—ì„œ **Credentials** > **[Create New]** > **`Google OAuth2 API`** ì„ íƒ.
2. **Client ID / Secret:** ë³µì‚¬í•´ë‘” ê°’ ë¶™ì—¬ë„£ê¸°.
3. **Scope (ì¤‘ìš”):** ì•„ë˜ URLì„ ì •í™•íˆ ì…ë ¥í•©ë‹ˆë‹¤.
```text
https://www.googleapis.com/auth/chat.messages

```

4. **Auth URI / Token URI:** ê¸°ë³¸ê°’ ìœ ì§€.
5. **[Sign in with Google]** í´ë¦­ > ë³¸ì¸ ê³„ì • ì„ íƒ > **[ê³ ê¸‰] > ì´ë™(unsafe)** > **[í—ˆìš©]**.

---

### 5-5. ë‚´ ìŠ¤í˜ì´ìŠ¤ ID ì°¾ê¸°

ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ì±„íŒ…ë°©(ìŠ¤í˜ì´ìŠ¤)ì˜ ì£¼ì†Œë¥¼ ì•Œì•„ì•¼ í•©ë‹ˆë‹¤.

1. ì›¹ë¸Œë¼ìš°ì €ë¡œ Google Chat(Gmail)ì˜ í•´ë‹¹ ìŠ¤í˜ì´ìŠ¤ì— ë“¤ì–´ê°‘ë‹ˆë‹¤.
2. URLì„ í™•ì¸í•©ë‹ˆë‹¤.
* ì˜ˆ: `https://mail.google.com/chat/u/0/#chat/space/AAAA1234abc`


3. ë§¨ ë’¤ì˜ **`AAAA1234abc`** ë¶€ë¶„ì´ ë°”ë¡œ **Space ID**ì…ë‹ˆë‹¤.

### 5-6. HTTP Request ë…¸ë“œ ì„¤ì •

ë§ˆì§€ë§‰ ë‹¨ê³„ì¸ **5ë²ˆ ë…¸ë“œ**ë¥¼ ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•©ë‹ˆë‹¤.

* **Node:** `HTTP Request`
* **Authentication:** `Predefined Credential Type` > **`Google OAuth2 API`** (ë°©ê¸ˆ ë§Œë“  ê²ƒ ì„ íƒ)
* **Method:** `POST`
* **URL:** (ì•„ë˜ URLì˜ `SPACE_ID`ë¥¼ ë³¸ì¸ ê²ƒìœ¼ë¡œ êµì²´)
```text
https://chat.googleapis.com/v1/spaces/SPACE_ID/messages

```


* *ì˜ˆ: `https://chat.googleapis.com/v1/spaces/AAAA1234abc/messages*`


* **Send Body:** `ON`
* **Body Content Type:** `JSON`
* **Body Parameters:**
* **Name:** `text`
* **Value:** `{{ $json.content }}` (OpenAIì˜ ìš”ì•½ ê²°ê³¼ ë³€ìˆ˜)




---

## âœ… ìµœì¢… ê²°ê³¼ í™•ì¸

1. **Test Workflow** ë²„íŠ¼ í´ë¦­
2. Google Chat ìŠ¤í˜ì´ìŠ¤ì— ìš”ì•½ëœ ë‰´ìŠ¤ê°€ ë´‡ ì´ë¦„ìœ¼ë¡œ ë„ì°©í–ˆëŠ”ì§€ í™•ì¸

---
